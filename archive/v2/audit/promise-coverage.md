# æ‰¿è¯ºè¦†ç›–åº¦çŸ©é˜µ

> é€æ¡å¯¹ç…§ AGENTS.md çš„æ¯ä¸ªæ‰¿è¯ºï¼Œæ˜ å°„åˆ°å®é™… hook å¼ºåˆ¶æœºåˆ¶ã€‚
> å®¡è®¡æ—¥æœŸï¼š2026-02-14

## å›¾ä¾‹

- ğŸŸ¢ ç¡¬é˜»æ–­ï¼šhook exit 2 é˜»æ­¢æ“ä½œ
- ğŸŸ¡ è½¯æé†’ï¼šhook stdout æ³¨å…¥ contextï¼Œagent å¯å¿½ç•¥
- ğŸ”´ æ— å¼ºåˆ¶ï¼šçº¯ prompt æ–‡å­—ï¼Œæ— ä»»ä½• hook

## è¦†ç›–åº¦çŸ©é˜µ

### Verification Firstï¼ˆéªŒè¯ä¼˜å…ˆï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| å®Œæˆå£°æ˜å‰å¿…é¡»æœ‰éªŒè¯è¯æ® | verify-completion (Stop) Phase B: æ£€æŸ¥æµ‹è¯•æ˜¯å¦é€šè¿‡ | ğŸŸ¡ è½¯æé†’ï¼ˆä¸èƒ½é˜»æ–­åœæ­¢ï¼‰ | ğŸŸ¢ å¯é… agent hook é˜»æ–­ | Kiro å¹³å°é™åˆ¶ï¼Œå·²æœ‰ PostToolUse å‰ç§»éªŒè¯è¡¥å¿ |
| è¯æ® â†’ å£°æ˜ï¼Œæ°¸è¿œä¸åè¿‡æ¥ | verify-completion Phase A: LLM 6 ç»´è¯„ä¼° | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ï¼ˆLLM åˆ¤æ–­ï¼‰ | LLM è¿”å›å¼‚å¸¸æ—¶æœ‰ fallbackï¼Œå¯æ¥å— |

### Workflowï¼ˆå·¥ä½œæµï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| Explore â†’ Plan â†’ Code | context-enrichmentï¼ˆå¤æ‚åº¦æ£€æµ‹â†’æé†’ planï¼‰+ enforce-skill-chainï¼ˆæ—  plan é˜»æ–­å†™ä»£ç ï¼‰ | ğŸŸ¡æé†’ + ğŸŸ¢é˜»æ–­å†™ä»£ç  | åŒå·¦ | **è°ƒç ”ï¼ˆExploreï¼‰æ­¥éª¤æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥è·³è¿‡è°ƒç ”ç›´æ¥å†™ plan |
| å¤æ‚ä»»åŠ¡å…ˆ interview | context-enrichmentï¼ˆå¤æ‚åº¦æ£€æµ‹â†’æé†’ brainstormingï¼‰ | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | **ğŸ”´ æ— ç¡¬é˜»æ–­**â€”â€”agent å¯å¿½ç•¥æé†’ç›´æ¥åŠ¨æ‰‹ |
| æ‰§è¡Œ â†’ éªŒè¯ â†’ ä¿®æ­£ | auto-test (PostToolUse) + verify-completion (Stop) | ğŸŸ¡+ğŸŸ¢ | ğŸŸ¡+ğŸŸ¢ | éªŒè¯æ­¥éª¤æœ‰ hookï¼Œä½†"ä¿®æ­£"æ— å¼ºåˆ¶ï¼ˆæµ‹è¯•å¤±è´¥å agent å¯ä»¥ä¸ä¿®ï¼‰ |

### Skill Routingï¼ˆæŠ€èƒ½è·¯ç”±ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| è§„åˆ’ â†’ brainstorming â†’ writing-plans â†’ reviewer è¾©è¯ | context-enrichmentï¼ˆæé†’ brainstormingï¼‰+ enforce-skill-chainï¼ˆè¦æ±‚ plan + reviewï¼‰ | ğŸŸ¡æé†’ + ğŸŸ¢é˜»æ–­ | åŒå·¦ | **brainstorming æ­¥éª¤æ— ç¡¬é˜»æ–­**â€”â€”agent å¯ä»¥ç›´æ¥å†™ plan è·³è¿‡ brainstormingï¼›**reviewer æ­¥éª¤æ— ç¡¬é˜»æ–­**â€”â€”enforce-skill-chain æ£€æŸ¥ ## Review å†…å®¹ä½† agent å¯ä»¥è‡ªå·±å†™å‡ review |
| æ‰§è¡Œ plan â†’ executing-plans æˆ– dispatching-parallel-agents | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥ä¸ç”¨ä»»ä½• skill ç›´æ¥æ‰§è¡Œ |
| å®Œæˆ â†’ verification â†’ reviewer éªŒæ”¶ â†’ code-review | verify-completion (Stop) Phase C æé†’ code review | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | **ğŸ”´ reviewer éªŒæ”¶æ— å¼ºåˆ¶**â€”â€”Stop hook åªæé†’ï¼Œä¸é˜»æ–­ |
| è°ƒè¯• â†’ systematic-debugging (NO fixes without root cause) | context-enrichmentï¼ˆdebug æ£€æµ‹â†’æé†’ç”¨ debug skillï¼‰ | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | **ğŸ”´ æ— ç¡¬é˜»æ–­**â€”â€”agent å¯ä»¥å¿½ç•¥æé†’ç›´æ¥çŒœæµ‹ä¿®å¤ |
| è°ƒç ” â†’ research skill | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |
| çº æ­£ â†’ self-reflect skill | context-enrichmentï¼ˆçº æ­£æ£€æµ‹â†’æ³¨å…¥ MUST æé†’ï¼‰+ Stop Phase Cï¼ˆæ£€æŸ¥ lessons-learned æ˜¯å¦æ›´æ–°ï¼‰ | ğŸŸ¡ è½¯æé†’ Ã— 2 | ğŸŸ¡ è½¯æé†’ Ã— 2 | åŒé‡è½¯æé†’ä½†æ— ç¡¬é˜»æ–­â€”â€”agent å¯ä»¥å¿½ç•¥çº æ­£ä¸å†™ lessons |

### Plan as Living Documentï¼ˆè®¡åˆ’å³æ´»æ–‡æ¡£ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| Plan æ–‡ä»¶æ˜¯å”¯ä¸€äº‹å®æ¥æº | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥åœ¨å¯¹è¯ä¸­åšå†³ç­–ä¸æ›´æ–° plan |
| å†³ç­–å˜æ›´å¿…é¡»ç«‹å³æ›´æ–°åˆ° plan | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |
| ä¿®æ”¹ plan æ ‡è®°åºŸå¼ƒä¸åˆ é™¤ | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |
| Context å‹ç¼©åé‡æ–°è¯» plan | æ— ï¼ˆKiro æ—  PreCompact hookï¼‰ | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |

### Knowledge Retrievalï¼ˆçŸ¥è¯†æ£€ç´¢ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| å¿…é¡»å¼•ç”¨æ¥æºæ–‡ä»¶ï¼Œä¸å¼•ç”¨=å¹»è§‰ | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥ç¼–é€ å¼•ç”¨ |
| æ¯æ¬¡ä»»åŠ¡å‰åå¿…æŸ¥ lessons-learned | context-enrichmentï¼ˆå¤æ‚ä»»åŠ¡æ—¶æé†’æŸ¥ lessonsï¼‰+ Stop Phase Cï¼ˆæé†’æ›´æ–° lessonsï¼‰ | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | åªåœ¨å¤æ‚ä»»åŠ¡æ—¶æé†’ï¼Œç®€å•ä»»åŠ¡ä¸æé†’ |

### Compound Interestï¼ˆè‡ªåŠ¨æ²‰æ·€ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| ç»“æ„åŒ–è¾“å‡ºå¿…é¡»å†™å…¥æ–‡ä»¶ | Stop Phase Cï¼ˆæé†’ï¼‰ | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | **ğŸ”´ æ— ç¡¬é˜»æ–­**â€”â€”agent å¯ä»¥åªåœ¨èŠå¤©ä¸­è¾“å‡ºä¸å†™æ–‡ä»¶ |
| æ“ä½œé‡å¤ â‰¥3 æ¬¡ â†’ Toolify First | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”æ— æ³•æ£€æµ‹é‡å¤æ“ä½œ |
| ä»»åŠ¡å®Œæˆåæ£€æŸ¥ç´¢å¼•æ›´æ–° | Stop Phase Cï¼ˆæé†’ï¼‰ | ğŸŸ¡ è½¯æé†’ | ğŸŸ¡ è½¯æé†’ | åªæ˜¯æé†’ |

### Self-Learningï¼ˆè‡ªè¿›åŒ–ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| æ£€æµ‹åˆ°çº æ­£ â†’ ç«‹å³å†™å…¥ç›®æ ‡æ–‡ä»¶ | context-enrichmentï¼ˆçº æ­£æ£€æµ‹â†’MUST æé†’ï¼‰+ Stop Phase Cï¼ˆæ£€æŸ¥ diff ä¸­æ˜¯å¦æœ‰ lessons å˜æ›´ï¼‰ | ğŸŸ¡ è½¯æé†’ Ã— 2 | ğŸŸ¡ è½¯æé†’ Ã— 2 | åŒé‡æé†’ä½†æ— ç¡¬é˜»æ–­ |

### Long-Running Tasksï¼ˆé•¿æ—¶é—´è¿è¡Œï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| é•¿ä»»åŠ¡å¼€å§‹æ—¶å†™ .completion-criteria.md | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥ä¸å†™ criteria ç›´æ¥å¼€å¹² |
| ä¼˜å…ˆæ‹†åˆ†ä¸ºå­ agent çŸ­ä»»åŠ¡ | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |

### Shell Safetyï¼ˆShell å®‰å…¨ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| è€—æ—¶å‘½ä»¤åŠ  timeout | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶**â€”â€”agent å¯ä»¥è£¸è·‘ `npm test` ä¸åŠ  timeout |
| ç½‘ç»œè¯·æ±‚åŠ  --max-time | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |
| ç¦æ­¢è£¸è·‘äº¤äº’å¼å‘½ä»¤ | æ—  | ğŸ”´ æ— å¼ºåˆ¶ | ğŸ”´ æ— å¼ºåˆ¶ | **ğŸ”´ å®Œå…¨æ— å¼ºåˆ¶** |

### Rulesï¼ˆè§„åˆ™ï¼‰

| å…·ä½“æ‰¿è¯º | Hook | Kiro å¼ºåˆ¶çº§åˆ« | CC å¼ºåˆ¶çº§åˆ« | ç¼ºå£ |
|---------|------|-------------|-----------|------|
| å®‰å…¨è§„åˆ™ç”± hooks å¼ºåˆ¶ | block-dangerous-commands + block-secrets + scan-skill-injection + block-sed-json | ğŸŸ¢ ç¡¬é˜»æ–­ | ğŸŸ¢ ç¡¬é˜»æ–­ | âœ… å·²è¦†ç›– |

### Hook æ³¨å†Œé…ç½®å®¡è®¡

| é…ç½®æ–‡ä»¶ | Hook | Matcher | ç¼ºå£ |
|---------|------|---------|------|
| default.json (Kiro) | block-dangerous-commands | `execute_bash` | âš ï¸ åªåŒ¹é… `execute_bash`ï¼Œä¸åŒ¹é… `shell`ï¼ˆKiro å·¥å…·åå¯èƒ½æ˜¯ `shell`ï¼‰ |
| default.json (Kiro) | block-secrets | `execute_bash` | åŒä¸Š |
| default.json (Kiro) | enforce-skill-chain | `fs_write` | âš ï¸ ä¸åŒ¹é… `write`ï¼ˆKiro å·¥å…·åå¯èƒ½æ˜¯ `write`ï¼‰ |
| default.json (Kiro) | scan-skill-injection | `fs_write` | åŒä¸Š |
| default.json (Kiro) | auto-test | `fs_write` | åŒä¸Š |
| default.json (Kiro) | block-sed-json | **æœªæ³¨å†Œ** | **ğŸ”´ block-sed-json åœ¨ default.json ä¸­å®Œå…¨æ²¡æœ‰æ³¨å†Œï¼** |
| default.json (Kiro) | auto-lint | **æœªæ³¨å†Œ** | **ğŸ”´ auto-lint åœ¨ default.json ä¸­å®Œå…¨æ²¡æœ‰æ³¨å†Œï¼** |
| default.json (Kiro) | enforce-tests | **æœªæ³¨å†Œ** | Kiro æ—  TaskCompleted äº‹ä»¶ï¼Œå¯æ¥å— |
| settings.json (CC) | block-sed-json | **æœªæ³¨å†Œ** | **ğŸ”´ block-sed-json åœ¨ CC settings.json ä¸­ä¹Ÿæ²¡æœ‰æ³¨å†Œï¼** |

## ç»Ÿè®¡

| å¼ºåˆ¶çº§åˆ« | æ•°é‡ | å æ¯” |
|---------|------|------|
| ğŸŸ¢ ç¡¬é˜»æ–­ | 4 | 14% |
| ğŸŸ¡ è½¯æé†’ | 10 | 36% |
| ğŸ”´ æ— å¼ºåˆ¶ | 14 | 50% |

**50% çš„æ‰¿è¯ºå®Œå…¨æ²¡æœ‰ä»»ä½•å¼ºåˆ¶æœºåˆ¶ã€‚**

## ç¼ºå£å†³ç­–

### A: å¯æ–°å¢ hook å¼ºåˆ¶ï¼ˆ5 é¡¹ï¼‰

| # | ç¼ºå£ | å»ºè®® hook |
|---|------|---------|
| A1 | Shell Safety: æ—  timeout/max-time | PreToolUse[Bash]: æ£€æµ‹é•¿æ—¶é—´å‘½ä»¤ï¼ˆnpm test/curl/wgetï¼‰æ—  timeout æ—¶æ³¨å…¥è­¦å‘Šæˆ–è‡ªåŠ¨åŒ…è£… |
| A2 | block-sed-json æœªæ³¨å†Œ | ç«‹å³æ³¨å†Œåˆ° default.json + settings.json |
| A3 | auto-lint æœªæ³¨å†Œ(Kiro) | æ³¨å†Œåˆ° default.json |
| A4 | Kiro matcher å·¥å…·åä¸ç¡®å®š | éªŒè¯ Kiro å®é™…å·¥å…·åæ˜¯ `execute_bash` è¿˜æ˜¯ `shell`ï¼Œæ˜¯ `fs_write` è¿˜æ˜¯ `write` |
| A5 | Self-Learning: çº æ­£åä¸å†™ lessons | å‡çº§ Stop hookï¼šçº æ­£ flag å­˜åœ¨ + lessons æœªå˜æ›´æ—¶ï¼Œè¾“å‡ºæ›´å¼ºçš„ MANDATORY è­¦å‘Šï¼ˆè€Œéå½“å‰çš„æ™®é€šæé†’ï¼‰ |

### B: å¯å¼ºåŒ–è½¯æé†’ï¼ˆ4 é¡¹ï¼‰

| # | ç¼ºå£ | å»ºè®® |
|---|------|------|
| B1 | Skill Routing: brainstorming/reviewer æ— ç¡¬é˜»æ–­ | context-enrichment å·²å‡çº§ä¸º MANDATORY æªè¾ï¼ˆæœ¬æ¬¡ä¼šè¯å·²ä¿®ï¼‰ï¼›enforce-skill-chain å·²æ£€æŸ¥ ## Review å†…å®¹ |
| B2 | Skill Routing: debug æ— ç¡¬é˜»æ–­ | context-enrichment å·²æœ‰ debug æ£€æµ‹ï¼Œæªè¾å¯å‡çº§ä¸º MANDATORY |
| B3 | Compound Interest: ç»“æ„åŒ–è¾“å‡ºä¸å†™æ–‡ä»¶ | Stop Phase C æé†’æªè¾å‡çº§ |
| B4 | Knowledge Retrieval: ä¸æŸ¥ lessons-learned | context-enrichment åœ¨æ‰€æœ‰é SIMPLE ä»»åŠ¡æ—¶æé†’ï¼ˆå·²å®ç°ï¼‰ |

### C: æ¥å—ä¸ºè½¯çº¦æŸï¼ˆ5 é¡¹ï¼‰

| # | ç¼ºå£ | åŸå›  |
|---|------|------|
| C1 | Plan as Living Documentï¼ˆ4 æ¡æ‰¿è¯ºå…¨æ— å¼ºåˆ¶ï¼‰ | æ— æ³•ç”¨ hook æ£€æµ‹"å¯¹è¯ä¸­åšäº†å†³ç­–ä½†æ²¡æ›´æ–° plan"â€”â€”éœ€è¦è¯­ä¹‰ç†è§£ |
| C2 | Knowledge Retrieval: å¿…é¡»å¼•ç”¨æ¥æº | æ— æ³•ç”¨ hook æ£€æµ‹å¼•ç”¨æ˜¯å¦çœŸå®â€”â€”éœ€è¦è¯­ä¹‰ç†è§£ |
| C3 | Compound Interest: Toolify First | æ— æ³•ç”¨ hook æ£€æµ‹æ“ä½œé‡å¤æ¬¡æ•°â€”â€”éœ€è¦è·¨ turn çŠ¶æ€ |
| C4 | Long-Running Tasks: å†™ completion-criteria | æ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦"é•¿"â€”â€”éœ€è¦è¯­ä¹‰ç†è§£ |
| C5 | Workflow: è°ƒç ”æ­¥éª¤ | æ— æ³•åˆ¤æ–­ agent æ˜¯å¦çœŸæ­£åšäº†è°ƒç ”â€”â€”éœ€è¦è¯­ä¹‰ç†è§£ |
